<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A Single Addin for Context Dependent Actions • tricks</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="A Single Addin for Context Dependent Actions">
<meta property="og:description" content="A Single Addin for Context Dependent Actions.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">tricks</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/moodymudskipper/tricks/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="tricks">tricks<a class="anchor" aria-label="anchor" href="#tricks"></a>
</h1></div>
<p>RStudio addins are handy but have flaws :</p>
<ul>
<li>They’re contained in packages, which are not straightforward to write/iterate on</li>
<li>It’s hard to remember which addins you’ve installed, and harder to remember the hotkeys you’ve set for them</li>
<li>The addin list soon becomes overwhelming since they’re all shown at all times, even when they don’t apply</li>
</ul>
<p>So in the end you might not write them much, and not use them much.</p>
<p>{tricks} is an attempt to solve those issues : * it works with a single hotkey * It proposes only relevant actions, by observing the context (selection, clipboard…) * It’s made very easy to add actions</p>
<p>A trick is defined by a condition, a label and an action, then:</p>
<ul>
<li>When the <strong>hotkey</strong> is triggered , all <strong>conditions</strong> are evaluated</li>
<li>For satisfied <strong>conditions</strong>, <strong>labels</strong> are proposed to the user</li>
<li>Once the <strong>label</strong> is selected, the <strong>action</strong> is triggered</li>
</ul>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"moodymudskipper/tricks"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="install-and-use-tricks">Install and use tricks<a class="anchor" aria-label="anchor" href="#install-and-use-tricks"></a>
</h2>
<p>Tricks are stored in YAML files, installed tricks are stored in a <code>.r-tricks.yaml</code> files located next to your <code>.Rprofile</code> files, this way you can define them at the project or at the user level.</p>
<p>These can be installed from packages or other YAML files using <code><a href="reference/install_tricks.html">install_tricks()</a></code>.</p>
<ul>
<li>
<code><a href="reference/install_tricks.html">install_tricks()</a></code> without arguments installs tricks that come with the {tricks} package.</li>
<li>
<code>install_tricks("some_tricks.yaml")</code> installs tricks defined in a specific file</li>
<li>
<code>install_tricks("pkg")</code> proposes you to install tricks from a package, the developer of such package should include a <code>tricks.yaml</code> file in the <code>inst</code> subfolder of their package.</li>
</ul>
<p><em>Insert gif describing <code><a href="reference/install_tricks.html">install_tricks()</a></code>, install a couple and apply them to a situation where they are not triggered at the same time</em></p>
</div>
<div class="section level2">
<h2 id="define-tricks-using-yaml-files">Define tricks using YAML files<a class="anchor" aria-label="anchor" href="#define-tricks-using-yaml-files"></a>
</h2>
<p>Designing your own tricks can be very fast, we’ll illustrate this with 3 tricks shipped with this package. To see all tricks defined in this package you can call <code>file.edit(system.file("tricks.yaml", package = "tricks"))</code></p>
<div class="section level3">
<h3 id="edit-zour-rprofile">Edit zour <code>.Rprofile</code>
<a class="anchor" aria-label="anchor" href="#edit-zour-rprofile"></a>
</h3>
<p>Do you know how to easily edit your user R Profile ? There’s a nice {usethis} function for this, but maybe you have problems remembering it, or you’d rather not have to type it.</p>
<p>We propose a trick to do that. If you trigger {tricks} when not selecting anything in the editor it will propose you to open your user R profile.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>Edit user <span class="st">'.Rprofile'</span><span class="sc">:</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>  description<span class="sc">:</span> Opens user <span class="st">'.Rprofile'</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  condition<span class="sc">:</span> <span class="fu">selection_is_empty</span>()</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  action<span class="sc">:</span> usethis<span class="sc">::</span><span class="fu">edit_r_profile</span>()</span></code></pre></div>
<p>We see below that whenever the selection is not empty the labels are not shown, but they are shown if the selection is empty.</p>
<p><em>INSERT GIF</em></p>
<p>Setting up tricks when the selection is empty is a good way to keep a list of bookmarks for actions you don’t want to remember how to trigger, maybe some other {usethis} workflow actions.</p>
<p><code><a href="reference/selection-condition-helpers.html">selection_is_empty()</a></code> is called a <strong>condition helper</strong>, and we have many of them, documented in :</p>
<ul>
<li>`?``selection-condition-helpers```</li>
<li>`?``file-condition-helpers```</li>
<li>`?``project-condition-helpers```</li>
<li>`?``clipboard-condition-helpers```</li>
<li>`?``system-condition-helpers```</li>
</ul>
</div>
<div class="section level3">
<h3 id="reprex-your-selection">Reprex your selection<a class="anchor" aria-label="anchor" href="#reprex-your-selection"></a>
</h3>
<p>The {reprex} package comes with a handy addin to create a reprex from a hotkey. You’ll have to remember how to trigger the hotkey though.</p>
<p>If you don’t want to we can set up a trick that will be proposed whenever we select parsable code that isn’t a symbol, when it is triggered it should call the relevant {reprex} addin.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>Reprex selection<span class="sc">:</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  description<span class="sc">:</span> Create a Reprex fron selection</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  condition<span class="sc">:</span> <span class="fu">selection_is_parsable</span>(<span class="at">symbol_ok =</span> <span class="cn">FALSE</span>)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>  action<span class="sc">:</span> <span class="fu">call_addin</span>(<span class="st">"reprex"</span>, <span class="st">"Reprex selection"</span>)</span></code></pre></div>
<p>We see below that whenever the selected code is parsable and is more than just a symbol, the action will be proposed.</p>
<p><em>INSERT GIF</em></p>
<p><code><a href="reference/selection-condition-helpers.html">selection_is_parsable()</a></code> is another <strong>condition helper</strong>. <code><a href="reference/action-helpers.html">call_addin()</a></code> is an <strong>action helper</strong>, there are more of them documented in `?``action-helpers```.</p>
<p>It is good practice to have narrow conditions around our use cases so as our list of tricks grows we only display those that apply.</p>
</div>
<div class="section level3">
<h3 id="debugonce">
<code>debugonce()</code><a class="anchor" aria-label="anchor" href="#debugonce"></a>
</h3>
<p>You might not like to type the name of a function when you want to debug, we might could define an addin to call <code><a href="https://rdrr.io/r/base/debug.html" class="external-link">debugonce()</a></code> on your selection but then you have to find an unused hotkey and remember it.</p>
<p>We can set a trick to <code><a href="https://rdrr.io/r/base/debug.html" class="external-link">debugonce()</a></code> a function, it should be proposed only if the selection is a symbol bound to a function.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">debugonce</span>({<span class="fu">current_selection</span>()})<span class="sc">:</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>  description<span class="sc">:</span> Call <span class="fu">debugonce</span>() on selected <span class="cf">function</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  condition<span class="sc">:</span> <span class="fu">selection_is_function</span>()</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  action<span class="sc">:</span> <span class="fu">debugonce</span>(.(<span class="fu">current_call</span>()))</span></code></pre></div>
<p>We see below that the action is proposed only if a symbol is selected and evaluates to a function.</p>
<p><em>INSERT GIF</em></p>
<p><code><a href="reference/selection-condition-helpers.html">selection_is_function()</a></code> is another <strong>condition helper</strong>. <code><a href="reference/current_selection.html">current_selection()</a></code> and <code><a href="reference/current_selection.html">current_call()</a></code> are <strong>context informers</strong>, they are documented in <code><a href="reference/current_selection.html">?current_selection</a></code>.</p>
<p>We note a couple new things here : * We used {glue} notation in the label, this is handy to provide custom labels * We used <code>.()</code> inside <code><a href="https://rdrr.io/r/base/debug.html" class="external-link">debugonce()</a></code>, this is the same <code>.()</code> that we find in <code><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote()</a></code>, <code><a href="https://rdrr.io/r/base/debug.html" class="external-link">debugonce()</a></code> uses NSE and supporting <code>.()</code> in actions and conditions permit us to program with such functions conveniently.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">load_tricks</span>(</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  <span class="st">"&lt;label1&gt;"</span> <span class="ot">=</span> <span class="er">&lt;</span>condition1<span class="sc">&gt;</span> <span class="er">~</span> <span class="er">&lt;</span>action1<span class="sc">&gt;</span>, </span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  <span class="st">"&lt;label2&gt;"</span> <span class="ot">=</span> <span class="er">&lt;</span>condition2<span class="sc">&gt;</span> <span class="er">~</span> <span class="er">&lt;</span>action2<span class="sc">&gt;</span>, </span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  ...)</span></code></pre></div>
<p>The package contains a set of functions to help you define actions and conditions conveniently.</p>
<p>Let’s go through a few examples.</p>
</div>
</div>
<div class="section level2">
<h2 id="define-tricks-with-load_tricks">Define tricks with <code>load_tricks()</code>
<a class="anchor" aria-label="anchor" href="#define-tricks-with-load_tricks"></a>
</h2>
<p>While we recommend using YAML files to store tricks, it might be useful to define tricks directly in R code for easier trial. This can be achieved using <code><a href="reference/load_tricks.html">load_tricks()</a></code>, its syntax is :</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>tricks<span class="sc">::</span><span class="fu">load_tricks</span>(</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>  <span class="st">"&lt;label1&gt;"</span> <span class="ot">=</span> <span class="er">&lt;</span>condition1<span class="sc">&gt;</span> <span class="er">~</span> <span class="er">&lt;</span>action1<span class="sc">&gt;</span>, </span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  <span class="st">"&lt;label2&gt;"</span> <span class="ot">=</span> <span class="er">&lt;</span>condition2<span class="sc">&gt;</span> <span class="er">~</span> <span class="er">&lt;</span>action2<span class="sc">&gt;</span>, </span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  ...)</span></code></pre></div>
<p>It also accepts trick objects defined with <code><a href="reference/new_trick.html">new_trick()</a></code></p>
<p>To reproduce the tricks showcased above we would run :</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tricks</span><span class="fu">::</span><span class="fu"><a href="reference/load_tricks.html">load_tricks</a></span><span class="op">(</span></span>
<span>  <span class="st">"Edit user '.Rprofile'"</span> <span class="op">=</span></span>
<span>    <span class="fu"><a href="reference/selection-condition-helpers.html">selection_is_empty</a></span><span class="op">(</span><span class="op">)</span> <span class="op">~</span>     </span>
<span>    <span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/edit.html" class="external-link">edit_r_profile</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span></span>
<span>  <span class="st">"Edit project '.Rprofile'"</span> <span class="op">=</span></span>
<span>    <span class="fu"><a href="reference/selection-condition-helpers.html">selection_is_empty</a></span><span class="op">(</span><span class="op">)</span> <span class="op">~</span>                      </span>
<span>    <span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/edit.html" class="external-link">edit_r_profile</a></span><span class="op">(</span>scope <span class="op">=</span> <span class="st">"project"</span><span class="op">)</span>, </span>
<span>  </span>
<span>  <span class="st">"Reprex selection"</span> <span class="op">=</span></span>
<span>    <span class="fu"><a href="reference/selection-condition-helpers.html">selection_is_parsable</a></span><span class="op">(</span>symbol_ok <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">~</span>  </span>
<span>    <span class="fu"><a href="reference/action-helpers.html">call_addin</a></span><span class="op">(</span><span class="st">"reprex"</span>, <span class="st">"Reprex selection"</span><span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co"># label : here using glue syntax to have dynamic action names</span></span>
<span>  <span class="st">"debugonce({current_selection()})"</span> <span class="op">=</span> </span>
<span>    <span class="co"># condition : selection evaluates to function</span></span>
<span>    <span class="fu"><a href="reference/selection-condition-helpers.html">selection_is_function</a></span><span class="op">(</span><span class="op">)</span> <span class="op">~</span> </span>
<span>    <span class="co"># action    : run debugonce, we use `bquote()`'s `.()` notation to work around NSE issues</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/debug.html" class="external-link">debugonce</a></span><span class="op">(</span><span class="fu">.</span><span class="op">(</span><span class="fu"><a href="reference/current_selection.html">current_call</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,      </span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="explore-and-edit-tricks">Explore and edit tricks<a class="anchor" aria-label="anchor" href="#explore-and-edit-tricks"></a>
</h2>
<ul>
<li>
<code><a href="reference/load_tricks.html">edit_tricks()</a></code> to open YAML file</li>
<li>
<code><a href="reference/install_tricks.html">install_tricks()</a></code> to add new entries to YAML files</li>
<li>
<code><a href="reference/load_tricks.html">uninstall_tricks()</a></code> to remove some</li>
<li>
<code><a href="reference/load_tricks.html">loaded_tricks()</a></code> or <code>View(loaded_tricks())</code> to explore loaded tricks</li>
<li>
<code><a href="reference/load_tricks.html">load_tricks()</a></code> to load trick objects or load tricks built from formulas</li>
<li>
<code><a href="reference/load_tricks.html">unload_tricks()</a></code> to unload some</li>
</ul>
</div>
<div class="section level2">
<h2 id="isnt-it-slow-to-have-a-lot-of-tricks--is-it-safe-">Isn’t it slow to have a lot of tricks ? Is it safe ?<a class="anchor" aria-label="anchor" href="#isnt-it-slow-to-have-a-lot-of-tricks--is-it-safe-"></a>
</h2>
<p>All of the helper functions are memoised so they will only be called once, and results will stay in memory while other conditions are evaluated. Given that most of these operations are pretty quick to begin with it’s unlikely that you’ll witness big lags. However if you push it you might succeed to design conditions that do take non trivial time to evaluate.</p>
<p>We discourage evaluating the selection (unless it’s a symbol) by forbidding the use of <code><a href="reference/current_selection.html">current_value()</a></code> in conditions. Evaluating a complex expression might take time and/or have side effects and this would really spoil the fun of {tricks}. Unless you try really hard, conditions won’t affect the global state so {tricks} can be used safely.</p>
<p>Moreover condition cannot trigger an error, if its code fails it just returns <code>FALSE</code>, the evaluation of conditions is also totally silent.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/moodymudskipper/tricks/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/moodymudskipper/tricks/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing tricks</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Antoine Fabri <br><small class="roles"> Author, maintainer </small>   </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Antoine Fabri.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.9000.</p>
</div>

      </footer>
</div>






  </body>
</html>
